IDENTIFICATION DIVISION.
PROGRAM-ID. FactorialCalculator.

ENVIRONMENT DIVISION.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-NUMBER          PIC 9(5) VALUE 0.
01 WS-FACTORIAL       PIC 9(18) VALUE 1.
01 WS-I               PIC 9(5) VALUE 0.

PROCEDURE DIVISION.
    DISPLAY "FACTORIAL CALCULATOR".
    DISPLAY "====================".
    
    PERFORM GET-NUMBER.
    PERFORM CALCULATE-FACTORIAL.
    PERFORM DISPLAY-RESULT.
    
    STOP RUN.

GET-NUMBER.
    DISPLAY "Enter a number (0-20): ".
    ACCEPT WS-NUMBER.
    IF WS-NUMBER < 0 OR WS-NUMBER > 20
        DISPLAY "Invalid input! Please enter a number between 0 and 20."
        PERFORM GET-NUMBER
    END-IF.

CALCULATE-FACTORIAL.
    IF WS-NUMBER = 0
        MOVE 1 TO WS-FACTORIAL
    ELSE
        MOVE 1 TO WS-I
        PERFORM UNTIL WS-I > WS-NUMBER
            COMPUTE WS-FACTORIAL = WS-FACTORIAL * WS-I
            ADD 1 TO WS-I
        END-PERFORM
    END-IF.

DISPLAY-RESULT.
    DISPLAY "The factorial of " WS-NUMBER " is: " WS-FACTORIAL.

